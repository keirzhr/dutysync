<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DutySync - Dashboard</title>
  
  <!-- CSS -->
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/inputduty.css">
  <link rel="stylesheet" href="../css/viewdutylog.css">
  <link rel="stylesheet" href="../css/profile.css">
  <link rel="stylesheet" href="../css/viewpayslip.css">
  <link rel="stylesheet" href="../css/generate.css">
  <link rel="stylesheet" href="../css/deduction-breakdown.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
</head>
<body>

  <!-- Sidebar -->
  <button class="hamburger" id="hamburger">☰</button>
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <img src="../images/logo.png" class="logo-img">
      <span class="logo-text">DutySync</span>
    </div>
    <nav class="nav-menu">
      <!-- Dashboard Section -->
      <div class="nav-section">
        <a class="nav-item" data-page="dashboard" data-parent="dashboard">
          <i class="fas fa-chart-pie nav-icon"></i>
          <span class="nav-text">Dashboard</span>
          <span class="nav-arrow">›</span>
        </a>
        <div class="sub-menu" id="dashboard-submenu">
          <a class="nav-item sub-item" data-page="overview"><span class="nav-text">Overview</span></a>
          <a class="nav-item sub-item" data-page="reports"><span class="nav-text">Reports</span></a>
          <a class="nav-item sub-item" data-page="input-duty"><span class="nav-text">Input Duty</span></a>
          <a class="nav-item sub-item" data-page="view-duty-log"><span class="nav-text">View Duty Log</span></a>
        </div>
      </div>
      <!-- Payslip Section -->
      <div class="nav-section">
        <a class="nav-item" data-page="generate-payslip">
          <i class="fas fa-money-bill-wave nav-icon"></i>
          <span class="nav-text">Payslip</span>
        </a>
      </div>
      
      <!-- Analytics Section -->
      <div class="nav-section">
        <a class="nav-item" data-page="analytics" data-parent="analytics">
          <i class="fas fa-chart-line nav-icon"></i>
          <span class="nav-text">Analytics</span>
          <span class="nav-arrow">›</span>
        </a>
        <div class="sub-menu" id="analytics-submenu">
          <a class="nav-item sub-item" data-page="net-pay-trends"><span class="nav-text">Net Pay Trends</span></a>
          <a class="nav-item sub-item" data-page="deduction-breakdown"><span class="nav-text">Deduction Breakdown</span></a>
        </div>
      </div>
      <!-- Settings & Help -->
      <a class="nav-item" data-page="settings"><i class="fas fa-cog nav-icon"></i><span class="nav-text">Settings</span></a>
      <a class="nav-item" data-page="help"><i class="fas fa-question-circle nav-icon"></i><span class="nav-text">Help</span></a>
    </nav>

    <!-- Updated Sidebar Footer with Profile Link -->
    <div class="sidebar-footer" id="sidebarFooterProfile">
      <div class="user-avatar" id="userAvatar">--</div>
      <div class="user-info">
        <div class="user-name" id="userName">Loading...</div>
        <div class="user-email" id="userEmail">Loading...</div>
      </div>
      <span class="user-arrow">›</span>
    </div>
  </aside>

  <!-- Toast container -->
  <div id="toastContainer" class="toast-container"></div>

  <!-- Main Content -->
  <main class="main-content">
    <header>
      <div class="header-content">
        <div class="breadcrumb">
          <span class="breadcrumb-parent" id="breadcrumbParent">Dashboard</span>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-current" id="breadcrumbCurrent"></span>
        </div>
        <button class="notification-btn" id="notificationBtn"><i class="fas fa-bell"></i><span class="notification-badge">3</span></button>
      </div>
    </header>

    <div class="content">

<!-- Profile Section (UPDATED) -->
<section class="content-section" id="profile">
  <div class="profile-container">
    <!-- Profile Header Card -->
    <div class="profile-header-card">
      <div class="profile-banner"></div>
      <div class="profile-info-section">
        <div class="profile-avatar-wrapper">
          <div class="profile-avatar-large" id="profileAvatarLarge">--</div>
          <!-- Add this inside the profile section, after profile-avatar-wrapper -->
          <input type="file" id="photoInput" accept="image/*" style="display: none;">

          <!-- Update the button to trigger file input -->
          <button class="avatar-edit-btn" id="avatarEditBtn" type="button">
            <i class="fas fa-camera"></i>
          </button>
        </div>
        <div class="profile-header-info">
          <h2 class="profile-name" id="profileName">Loading...</h2>
          <p class="profile-email" id="profileEmail">Loading...</p>
          <div class="profile-badges">
            <span class="profile-badge" id="profilePosition">Manager</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Profile Details Card -->
    <div class="profile-details-card">
      <div class="profile-card-header">
        <h3>Personal Information</h3>
      </div>

      <div class="profile-form" id="profileForm">
        <!-- Full Name -->
        <div class="profile-field-group">
          <label class="profile-label">Full Name</label>
          <div class="profile-field">
            <i class="fas fa-user field-icon"></i>
            <input type="text" id="profileFullName" class="profile-input" disabled>
          </div>
        </div>

        <!-- Email -->
        <div class="profile-field-group">
          <label class="profile-label">Email Address</label>
          <div class="profile-field">
            <i class="fas fa-envelope field-icon"></i>
            <input type="email" id="profileEmailInput" class="profile-input" disabled>
          </div>
        </div>

        <!-- Phone -->
        <div class="profile-field-group">
          <label class="profile-label">Phone Number</label>
          <div class="profile-field">
            <i class="fas fa-phone field-icon"></i>
            <input type="tel" id="profilePhone" class="profile-input" placeholder="Enter phone number" disabled>
          </div>
        </div>

        <!-- Position -->
        <div class="profile-field-group">
          <label class="profile-label">Position</label>
          <div class="profile-field">
            <i class="fas fa-briefcase field-icon"></i>
            <input type="text" id="profilePositionInput" class="profile-input" placeholder="Enter position" disabled>
          </div>
        </div>

        <!-- Location -->
        <div class="profile-field-group">
          <label class="profile-label">Location</label>
          <div class="profile-field">
            <i class="fas fa-map-marker-alt field-icon"></i>
            <input type="text" id="profileLocation" class="profile-input" placeholder="Enter location" disabled>
          </div>
        </div>

        <!-- Hire Date -->
        <div class="profile-field-group">
          <label class="profile-label">Hire Date</label>
          <div class="profile-field">
            <i class="fas fa-calendar field-icon"></i>
            <input type="date" id="profileHireDate" class="profile-input" disabled>
          </div>
        </div>

        <!-- Action Buttons (Hidden by default) -->
        <div class="profile-actions" id="profileActions" style="display: none;">
          <button class="btn-cancel-profile" id="btnCancelProfile">
            <i class="fas fa-times"></i> Cancel
          </button>
          <button class="btn-save-profile" id="btnSaveProfile">
            <i class="fas fa-save"></i> Save Changes
          </button>
        </div>

        <!-- Edit Button (Visible by default) -->
        <div class="profile-actions-default" id="profileActionsDefault">
          <button class="btn-edit-profile" id="btnEditProfile">
            <i class="fas fa-edit"></i> Edit Profile
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

  <!-- Generate Payslip Section - Add this to dashboard.html -->
<section class="content-section" id="generate-payslip">
  <div class="generate-payslip-container">
    <!-- Main Layout -->
    <div class="generate-layout">
      <!-- Left Column: Input Form -->
      <div class="generate-form-section">
        <div class="form-card">
          <div class="form-card-header">
            <i class="fas fa-calculator"></i>
            <h3>Payroll Calculator</h3>
          </div>

          <div class="form-card-body">
            <!-- Employee Info Display -->

            <!-- Period Selection -->
            <div class="form-section-group">
              <label class="form-section-label">Pay Period</label>
              <div class="period-selectors">
                <div class="select-wrapper">
                  <label for="generateYear">Year</label>
                  <select id="generateYear" class="form-select">
                    <!-- Populated by JS -->
                  </select>
                </div>
                <div class="select-wrapper">
                  <label for="generateMonth">Month</label>
                  <select id="generateMonth" class="form-select">
                    <option value="1">January</option>
                    <option value="2">February</option>
                    <option value="3">March</option>
                    <option value="4">April</option>
                    <option value="5">May</option>
                    <option value="6">June</option>
                    <option value="7">July</option>
                    <option value="8">August</option>
                    <option value="9">September</option>
                    <option value="10">October</option>
                    <option value="11">November</option>
                    <option value="12">December</option>
                  </select>
                </div>
                <div class="select-wrapper">
                  <label for="generateCutoff">Cutoff</label>
                  <select id="generateCutoff" class="form-select">
                    <option value="1">1st – 15th</option>
                    <option value="2">16th – 30th/31st</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Rate Input -->
        <div class="form-section-group">
          <label class="form-section-label">Rate Configuration</label>
          <div class="rate-config">
            <div class="rate-type-toggle">
              <button type="button" class="rate-btn active" data-type="hourly">
                <i class="fas fa-clock"></i> Per Hour
              </button>
              <button type="button" class="rate-btn" data-type="daily">
                <i class="fas fa-calendar-day"></i> Per Day
              </button>
            </div>
            
            <!-- Rate Input Container -->
            <div id="rateInputContainer" style="display: flex; flex-direction: column;">
              <div class="rate-input-wrapper">
                <span class="currency-symbol">₱</span>
                <input 
                  type="number" 
                  id="rateInput" 
                  class="rate-input" 
                  placeholder="0.00" 
                  step="0.01" 
                  min="0"
                >
                <span class="rate-label" id="rateLabel">/hour</span>
              </div>
              
              <!-- Edit button will be inserted here by JavaScript for existing users -->
            </div>
            
            <!-- Status indicator for existing users -->
            <small id="rateStatus" class="help-text" style="margin-top: 8px; display: none;">
              <i class="fas fa-lock"></i> Using saved default rate
            </small>
          </div>
        </div>

            <!-- Hours Summary (Auto-calculated) -->
           <!-- Hours Summary (Auto-calculated) -->
<div class="form-section-group">
  <label class="form-section-label">Hours Summary</label>
  
  <div class="hours-summary-grid">
    <div class="hours-item">
      <div class="hours-icon regular">
        <i class="fas fa-briefcase"></i>
      </div>
      <div class="hours-details">
        <span class="hours-label">Regular Hours</span>
        <span class="hours-value" id="summaryRegularHours">0.00</span>
      </div>
    </div>
    
    <div class="hours-item">
      <div class="hours-icon overtime">
        <i class="fas fa-hourglass-half"></i>
      </div>
      <div class="hours-details">
        <span class="hours-label">Overtime Hours</span>
        <span class="hours-value" id="summaryOvertimeHours">0.00</span>
      </div>
    </div>
    
    <div class="hours-item">
      <div class="hours-icon night">
        <i class="fas fa-moon"></i>
      </div>
      <div class="hours-details">
        <span class="hours-label">Night Diff Hours</span>
        <span class="hours-value" id="summaryNightHours">0.00</span>
      </div>
    </div>
    
    <div class="hours-item">
      <div class="hours-icon holiday">
        <i class="fas fa-gift"></i>
      </div>
      <div class="hours-details">
        <span class="hours-label">Holiday Hours</span>
        <span class="hours-value" id="summaryHolidayHours">0.00</span>
      </div>
    </div>
  </div>

  <div class="hours-item total-worked-card">
    <div class="hours-icon worked">
      <i class="fas fa-check-circle"></i>
    </div>
    <div class="hours-details">
      <span class="hours-label">Total Worked (Physical Hours)</span>
      <span class="hours-value" id="summaryWorkedHours">0.00</span>
    </div>
  </div>
</div>            <!-- Calculate Button -->
            <button type="button" id="calculatePayslipBtn" class="btn-calculate">
              <i class="fas fa-calculator"></i> Calculate Payslip
            </button>
          </div>
        </div>
      </div>

      <!-- Right Column: Preview Card -->
      <div class="generate-preview-section">
        <div class="preview-card">
          <div class="preview-header">
            <div class="preview-logo">
              <img src="../images/logo.png" alt="Logo" class="preview-logo-img">
              <span>DutySync</span>
            </div>
            <div class="preview-badge">PAYSLIP</div>
          </div>

          <!-- Employee Info in Preview -->
          <div class="preview-employee-info">
            <div class="preview-employee-row">
              <span class="info-label">Employee Name:</span>
              <span class="info-value" id="previewEmployeeName">---</span>
            </div>
            <div class="preview-employee-row">
              <span class="info-label">Position:</span>
              <span class="info-value" id="previewEmployeePosition">---</span>
            </div>
            <div class="preview-employee-row">
              <span class="info-label">Email:</span>
              <span class="info-value" id="previewEmployeeEmail">---</span>
            </div>
          </div>

          <div class="preview-period">
            <span class="period-label">Pay Period:</span>
            <span class="period-value" id="previewPeriod">Select period</span>
          </div>

<div class="preview-body">
  <!-- Two Column Grid for Earnings and Deductions -->
  <div class="preview-sections-grid">
    
    <!-- Earnings Section (Left Column) -->
    <div class="preview-section">
      <h4 class="preview-section-title">
        <i class="fas fa-plus-circle"></i> Earnings
      </h4>
      <div class="preview-section-content">
        <div class="preview-row">
          <span>Basic Pay</span>
          <span id="previewBasicPay">₱0.00</span>
        </div>
        <div class="preview-row">
          <span>Overtime Pay</span>
          <span id="previewOvertimePay">₱0.00</span>
        </div>
        <div class="preview-row">
          <span>Night Differential</span>
          <span id="previewNightDiff">₱0.00</span>
        </div>
        <div class="preview-row">
          <span>Holiday Pay</span>
          <span id="previewHolidayPay">₱0.00</span>
        </div>
        <div class="preview-row total">
          <span>Gross Pay</span>
          <span id="previewGrossPay">₱0.00</span>
        </div>
      </div>
    </div>

    <!-- Deductions Section (Right Column) -->
    <div class="preview-section">
      <h4 class="preview-section-title">
        <i class="fas fa-minus-circle"></i> Deductions
      </h4>
      <div class="preview-section-content">
        <div class="preview-row">
          <span>SSS</span>
          <span id="previewSSS">₱0.00</span>
        </div>
        <div class="preview-row">
          <span>PhilHealth</span>
          <span id="previewPhilHealth">₱0.00</span>
        </div>
        <div class="preview-row">
          <span>Pag-IBIG</span>
          <span id="previewPagibig">₱0.00</span>
        </div>
        <div class="preview-row">
          <span>BIR Tax</span>
          <span id="previewBIRTax">₱0.00</span>
        </div>
        <div class="preview-row total deduction">
          <span>Total Deductions</span>
          <span id="previewTotalDeductions">₱0.00</span>
        </div>
      </div>
    </div>
    
  </div>

  <!-- Net Pay (Full Width Below) -->
  <div class="preview-net-pay">
    <span class="net-label">NET PAY</span>
    <span class="net-value" id="previewNetPay">₱0.00</span>
  </div>
</div>
          <div class="preview-footer">
            <button type="button" id="generatePdfBtn" class="btn-generate" disabled>
              <i class="fas fa-file-pdf"></i> Generate Payslip
            </button>
          </div>
        </div>

        <!-- Status Messages -->
        <div id="generateStatus" class="generate-status" style="display: none;">
          <div class="status-content">
            <i class="fas fa-spinner fa-spin"></i>
            <span>Generating payslip...</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Success Modal -->
  <div id="payslipSuccessModal" class="modal-overlay">
    <div class="modal-content success-modal">
      <div class="success-icon">
        <i class="fas fa-check-circle"></i>
      </div>
      <h3>Payslip Generated!</h3>
      <p>Your payslip has been successfully generated and saved.</p>
      <div class="modal-buttons">
        <button class="btn-modal btn-view" id="viewPayslipBtn">
          <i class="fas fa-eye"></i> View Payslip
        </button>
        <button class="btn-modal btn-close" onclick="closeSuccessModal()">Close</button>
      </div>
    </div>
  </div>

  <!-- ADD THIS SECTION INSIDE THE generate-payslip-container DIV, 
     AFTER THE generate-layout DIV CLOSES -->

<!-- Payslip History Section -->
<div class="payslip-history-section" id="payslipHistorySection">
  <div class="history-section-header">
    <h3>
      <i class="fas fa-history"></i>
      Payslip History
      <span class="history-count" id="historyCount">0</span>
    </h3>
  </div>

  <!-- History Container (populated by JavaScript) -->
  <div id="payslipHistoryContainer">
    <!-- Cards will be dynamically generated here -->
    <div class="history-empty-state">
      <i class="fas fa-file-invoice" style="font-size: 48px; color: #ccc; margin-bottom: 16px;"></i>
      <h3>No Payslip History</h3>
      <p>Generated payslips will appear here</p>
    </div>
  </div>
</div>

<!-- UPDATE THE SUCCESS MODAL TO REMOVE THE VIEW BUTTON SINCE WE'RE NOT USING FIREBASE STORAGE -->
<!-- Keep the existing modal but update the buttons section: -->

<div id="payslipSuccessModal" class="modal-overlay">
  <div class="modal-content success-modal">
    <div class="success-icon">
      <i class="fas fa-check-circle"></i>
    </div>
    <h3>Payslip Generated!</h3>
    <p>Your payslip has been successfully generated and saved to your history.</p>
    <div class="modal-buttons">
      <button class="btn-modal btn-close" onclick="closeSuccessModal()">
        <i class="fas fa-check"></i> Done
      </button>
    </div>
  </div>
</div>

</section>
      <!-- Input Duty Section -->
      <section class="content-section" id="input-duty">
        <div class="calendar-graph-container">
          <div class="month-switcher">
            <button id="prevMonth">&lt;</button>
            <div id="currentMonth">November 2025</div>
            <button id="nextMonth">&gt;</button>
          </div>
          <div class="calendar-graph-wrapper">
          
            <div class="calendar-wrapper">
              <h3 class="calendar-title">Work Hours Input</h3>
              <div id="calendarContainer" class="calendar-grid"></div>
            </div>

            <div class="graph-wrapper">
              <h3>Hours Worked</h3>
              <canvas id="completedTimeChart"></canvas>

              <div class="cutoff-hours-box">
                <div class="cutoff-block">
                  <h4>Cutoff (1–15)</h4>
                  <p id="hours_1_15">0 hrs</p>
                </div>

                <div class="cutoff-block">
                  <h4>Cutoff (16–30)</h4>
                  <p id="hours_16_30">0 hrs</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Delete Confirmation Modal -->
        <div id="deleteConfirmationModal" class="confirmation-modal">
          <div class="confirmation-content">
            <div class="confirmation-icon">
              <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3 class="confirmation-title">Delete Entry?</h3>
            <p class="confirmation-message">
              This action cannot be undone. Are you sure you want to delete this duty record?
            </p>
            <div class="confirmation-buttons">
              <button id="cancelDeleteBtn" class="conf-btn conf-btn-cancel">
                <i class="fas fa-times"></i> Keep
              </button>
              <button id="confirmDeleteBtn" class="conf-btn conf-btn-danger">
                <i class="fas fa-trash"></i> Delete
              </button>
            </div>
          </div>
        </div>

        <!-- Popup Modal -->
        <!-- Popup Modal - CLEAN AUTO VERSION -->
<div id="popupOverlay" class="popup-overlay">
  <div id="dutyPopup" class="popup-card">
    <div class="popup-header">
      <h3>Log Work Duty</h3>
    </div>
    
    <!-- Error Message Display -->
    <div id="popupError" class="popup-error" style="display: none;"></div>
    
    <div class="popup-content">
      <!-- Date Section -->
      <div class="popup-section">
        <label class="section-label">Date</label>
        <input type="date" id="popupDate" readonly class="date-input">
      </div>

      <!-- Time Section -->
      <div class="popup-section">
        <label class="section-label">Work Hours</label>
        <div class="time-input-group">
          <div class="time-input-wrapper">
            <label for="popupTimeIn" class="input-label">Time In <span class="required">*</span></label>
            <input type="time" id="popupTimeIn" placeholder="HH:MM" class="time-input">
            <small class="help-text">Start time</small>
          </div>
          <div class="time-separator">→</div>
          <div class="time-input-wrapper">
            <label for="popupTimeOut" class="input-label">Time Out <span class="required">*</span></label>
            <input type="time" id="popupTimeOut" placeholder="HH:MM" class="time-input">
            <small class="help-text">End time</small>
          </div>
        </div>
      </div>

      <!-- Day Type Section -->
      <div class="popup-section">
        <label class="section-label">Day Type</label>
        <select id="popupDayType" class="select-input">
          <option>Regular</option>
          <option>Regular Holiday (130%)</option>
          <option>Special Non-Working Holiday (200%)</option>
        </select>
      </div>

      <!-- AUTO PREVIEW SECTION -->
      <div class="popup-section">
        <label class="section-label">Automatic Calculation Preview</label>
        <div class="auto-preview-box">
          <div class="preview-row">
            <span class="preview-label">
              <i class="fas fa-sun"></i> Regular Hours
            </span>
            <span class="preview-value" id="previewRegular">0.00 hrs</span>
          </div>
          <div class="preview-row">
            <span class="preview-label">
              <i class="fas fa-moon"></i> Night Diff (10PM-6AM)
            </span>
            <span class="preview-value night" id="previewNight">0.00 hrs</span>
          </div>
          <div class="preview-row">
            <span class="preview-label">
              <i class="fas fa-clock"></i> Overtime (>8 hrs)
            </span>
            <span class="preview-value overtime" id="previewOT">0.00 hrs</span>
          </div>
          <div class="preview-row total">
            <span class="preview-label">
              <i class="fas fa-check-circle"></i> Total Hours
            </span>
            <span class="preview-value" id="previewTotal">0.00 hrs</span>
          </div>
        </div>
        <small class="help-text" style="margin-top: 8px; display: block;">
          <i class="fas fa-info-circle"></i> All calculations are automatic based on your time entries
        </small>
      </div>
    </div>

    <!-- Buttons -->
    <div class="popup-buttons">
      <button id="savePopupDuty" class="popup-btn popup-btn-save">Save</button>
      <button id="cancelPopupDuty" class="popup-btn popup-btn-cancel">Cancel</button>
    </div>
  </div>
</div>
      </section>

      <!-- View Duty Log Section -->
      <section class="content-section" id="view-duty-log">
        <div class="duty-log-container">
          <div class="duty-log-header">
            <h2 class="section-title">Duty Records</h2>
            <div class="duty-log-controls">
              <input type="month" id="monthFilter" class="month-filter">
            </div>
          </div>

          <!-- Table and Dashboard Layout -->
          <div class="duty-content-layout">
            <!-- Table -->
          <div class="duty-table-wrapper">
            <table class="duty-table" id="dutyTable">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Time In</th>
                  <th>Time Out</th>
                  <th>Hours</th>
                  <th>Night Diff</th>
                  <th>Day Type</th>
                  <th>Overtime</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="dutyTableBody">
                  <!-- Populated by JavaScript -->
                </tbody>
              </table>
            </div>

            <!-- Mini Dashboard (Below Table) -->
            <div class="mini-dashboard" id="miniDashboard">
              <div class="dashboard-card">
                <div class="card-label">Total Hour</div>
                <div class="card-value" id="dashTotalHours">0.00</div>
              </div>
              
              <div class="dashboard-card">
                <div class="card-label">Regular Hour</div>
                <div class="card-value" id="dashRegularHours">0.00</div>
              </div>
              
              <div class="dashboard-card">
                <div class="card-label">Night Differential</div>
                <div class="card-value night-shift" id="dashNightHours">0.00</div>
              </div>
              
              <div class="dashboard-card">
                <div class="card-label">Special Day Hour</div>
                <div class="card-value special-day" id="dashSpecialDayHours">0.00</div>
              </div>
              
              <div class="dashboard-card">
                <div class="card-label">Over Time Hour</div>
                <div class="card-value overtime" id="dashOverTimeHours">0.00</div>
              </div>
              
              <div class="dashboard-card">
                <div class="card-label">Total work availability</div>
                <div class="card-value percentage" id="dashAvailability">%0.00</div>
              </div>
            </div>
          </div>

          <!-- Mobile Card View (Hidden on Desktop) -->
          <div class="duty-cards-wrapper" id="dutyCardsWrapper">
            <!-- Populated by JavaScript -->
          </div>

          <!-- Empty State (Fallback) -->
          <div class="duty-empty-state" id="dutyEmptyState" style="display: none;">
            <i class="fas fa-calendar-times"></i>
            <h3>No Duty Records</h3>
            <p>No records found for the selected month. Try selecting a different month or add new duty entries.</p>
            <button class="btn-add-duty" onclick="document.querySelector('[data-page=\'input-duty\']').click()">
              <i class="fas fa-plus"></i> Add Duty Record
            </button>
          </div>
        </div>

        <!-- Edit Duty Modal -->
        <!-- Edit Duty Modal - AUTO VERSION -->
<div id="dutyLogEditModal" class="popup-overlay">
  <div class="popup-card">
    <div class="popup-header">
      <h3>Edit Duty Record</h3>
    </div>
    
    <div id="editDutyError" class="popup-error" style="display: none;"></div>
    
    <div class="popup-content">
      <input type="hidden" id="editDutyId">
      
      <div class="popup-section">
        <label class="section-label">Date</label>
        <input type="date" id="editDutyDate" class="date-input" readonly>
      </div>

      <div class="popup-section">
        <label class="section-label">Work Hours</label>
        <div class="time-input-group">
          <div class="time-input-wrapper">
            <label for="editDutyTimeIn" class="input-label">Time In <span class="required">*</span></label>
            <input type="time" id="editDutyTimeIn" class="time-input">
            <small class="help-text">Start time</small>
          </div>
          <div class="time-separator">→</div>
          <div class="time-input-wrapper">
            <label for="editDutyTimeOut" class="input-label">Time Out <span class="required">*</span></label>
            <input type="time" id="editDutyTimeOut" class="time-input">
            <small class="help-text">End time</small>
          </div>
        </div>
      </div>

      <div class="popup-section">
        <label class="section-label">Day Type</label>
        <select id="editDutyDayType" class="select-input">
          <option>Regular</option>
          <option>Regular Holiday (130%)</option>
          <option>Special Non-Working Holiday (200%)</option>
        </select>
      </div>

      <!-- AUTO PREVIEW SECTION -->
      <div class="popup-section">
        <label class="section-label">Automatic Calculation Preview</label>
        <div class="auto-preview-box">
          <div class="preview-row">
            <span class="preview-label">
              <i class="fas fa-sun"></i> Regular Hours
            </span>
            <span class="preview-value" id="editPreviewRegular">0.00 hrs</span>
          </div>
          <div class="preview-row">
            <span class="preview-label">
              <i class="fas fa-moon"></i> Night Diff (10PM-6AM)
            </span>
            <span class="preview-value night" id="editPreviewNight">0.00 hrs</span>
          </div>
          <div class="preview-row">
            <span class="preview-label">
              <i class="fas fa-clock"></i> Overtime (>8 hrs)
            </span>
            <span class="preview-value overtime" id="editPreviewOT">0.00 hrs</span>
          </div>
          <div class="preview-row total">
            <span class="preview-label">
              <i class="fas fa-check-circle"></i> Total Hours
            </span>
            <span class="preview-value" id="editPreviewTotal">0.00 hrs</span>
          </div>
        </div>
        <small class="help-text" style="margin-top: 8px; display: block;">
          <i class="fas fa-info-circle"></i> All calculations are automatic based on your time entries
        </small>
      </div>
    </div>

    <div class="popup-buttons">
      <button onclick="saveEditedDuty()" class="popup-btn popup-btn-update">Update</button>
      <button onclick="closeEditModal()" class="popup-btn popup-btn-cancel">Cancel</button>
    </div>
  </div>
</div>

        <!-- Delete Confirmation Modal -->
        <div id="dutyLogDeleteModal" class="confirmation-modal">
          <div class="confirmation-content">
            <div class="confirmation-icon">
              <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3 class="confirmation-title">Delete Entry?</h3>
            <p class="confirmation-message">
              This action cannot be undone. Are you sure you want to delete this duty record?
            </p>
            <div class="confirmation-buttons">
              <button id="cancelDutyLogDelete" class="conf-btn conf-btn-cancel">
                <i class="fas fa-times"></i> Keep
              </button>
              <button id="confirmDutyLogDelete" class="conf-btn conf-btn-danger">
                <i class="fas fa-trash"></i> Delete
              </button>
            </div>
          </div>
        </div>
      </section>


    <!-- Deduction Breakdown Section -->
<section class="content-section" id="deduction-breakdown">
  <div class="deduction-breakdown-container">
    
    <!-- Header with Period Selector -->
    <div class="breakdown-header">
      <h2 class="section-title">
        <i></i> Deduction Breakdown
      </h2>
      <div class="period-selector-group">
        <select id="breakdownMonth" class="breakdown-select">
          <option value="all">All Months</option>
          <option value="1">January</option>
          <option value="2">February</option>
          <option value="3">March</option>
          <option value="4">April</option>
          <option value="5">May</option>
          <option value="6">June</option>
          <option value="7">July</option>
          <option value="8">August</option>
          <option value="9">September</option>
          <option value="10">October</option>
          <option value="11">November</option>
          <option value="12">December</option>
        </select>
        <select id="breakdownYear" class="breakdown-select">
          <!-- Populated by JS -->
        </select>
      </div>
    </div>

    <!-- Summary Cards -->
    <div class="deduction-summary-cards">
      <div class="deduction-card total">
        <div class="card-icon">
          <i class="fas fa-wallet"></i>
        </div>
        <div class="card-content">
          <span class="card-label">Total Deductions</span>
          <span class="card-value" id="totalDeductions">₱0.00</span>
          <span class="card-trend" id="totalTrend"></span>
        </div>
      </div>

      <div class="deduction-card sss">
        <div class="card-icon">
          <i class="fas fa-shield-alt"></i>
        </div>
        <div class="card-content">
          <span class="card-label">
            SSS
            <i class="fas fa-info-circle tooltip-trigger" data-tooltip="Social Security System - Retirement, disability, and sickness benefits"></i>
          </span>
          <span class="card-value" id="sssDeduction">₱0.00</span>
          <span class="card-percentage" id="sssPercent">0%</span>
        </div>
      </div>

      <div class="deduction-card philhealth">
        <div class="card-icon">
          <i class="fas fa-heartbeat"></i>
        </div>
        <div class="card-content">
          <span class="card-label">
            PhilHealth
            <i class="fas fa-info-circle tooltip-trigger" data-tooltip="Philippine Health Insurance - Medical and hospitalization coverage"></i>
          </span>
          <span class="card-value" id="philhealthDeduction">₱0.00</span>
          <span class="card-percentage" id="philhealthPercent">0%</span>
        </div>
      </div>

      <div class="deduction-card pagibig">
        <div class="card-icon">
          <i class="fas fa-home"></i>
        </div>
        <div class="card-content">
          <span class="card-label">
            Pag-IBIG
            <i class="fas fa-info-circle tooltip-trigger" data-tooltip="Home Development Mutual Fund - Housing loans and savings"></i>
          </span>
          <span class="card-value" id="pagibigDeduction">₱0.00</span>
          <span class="card-percentage" id="pagibigPercent">0%</span>
        </div>
      </div>

      <div class="deduction-card tax">
        <div class="card-icon">
          <i class="fas fa-file-invoice-dollar"></i>
        </div>
        <div class="card-content">
          <span class="card-label">
            BIR Tax
            <i class="fas fa-info-circle tooltip-trigger" data-tooltip="Bureau of Internal Revenue - Withholding tax based on income brackets"></i>
          </span>
          <span class="card-value" id="taxDeduction">₱0.00</span>
          <span class="card-percentage" id="taxPercent">0%</span>
        </div>
      </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-container">
      
      <!-- Donut Chart -->
      <div class="chart-card">
        <div class="chart-header">
          <h3>
            <i class="fas fa-chart-pie"></i>
            Deduction Distribution
          </h3>
          <span class="chart-subtitle">Current Period Breakdown</span>
        </div>
        <div class="chart-body">
          <canvas id="deductionDonutChart"></canvas>
          <div class="chart-legend" id="donutLegend"></div>
        </div>
      </div>

      <!-- Trend Line Chart -->
      <div class="chart-card wide">
        <div class="chart-header">
          <h3>
            <i class="fas fa-chart-line"></i>
            6-Month Deduction Trends
          </h3>
          <span class="chart-subtitle">Historical Overview</span>
        </div>
        <div class="chart-body">
          <canvas id="deductionTrendChart"></canvas>
        </div>
      </div>

    </div>

    <!-- Gross-to-Net Ratio Card -->
    <div class="ratio-card">
      <div class="ratio-content">
        <div class="ratio-icon">
          <i class="fas fa-percentage"></i>
        </div>
        <div class="ratio-details">
          <h3>Take-Home Pay Ratio</h3>
          <p class="ratio-description">Percentage of gross income after deductions</p>
          <div class="ratio-bar-container">
            <div class="ratio-bar" id="ratioBar"></div>
          </div>
          <div class="ratio-stats">
            <div class="stat-item">
              <span class="stat-label">Gross Pay:</span>
              <span class="stat-value" id="grossPayDisplay">₱0.00</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Net Pay:</span>
              <span class="stat-value highlight" id="netPayDisplay">₱0.00</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">You Keep:</span>
              <span class="stat-value highlight" id="keepPercentage">0%</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Detailed Breakdown Table -->
    <div class="breakdown-table-card">
      <div class="table-header">
        <h3>
          <i class="fas fa-table"></i>
          Historical Breakdown
        </h3>
        <button class="btn-export" id="exportBreakdownBtn">
          <i class="fas fa-download"></i> Export Data
        </button>
      </div>
      <div class="table-wrapper">
        <table class="breakdown-table">
          <thead>
            <tr>
              <th>Period</th>
              <th>Gross Pay</th>
              <th>SSS</th>
              <th>PhilHealth</th>
              <th>Pag-IBIG</th>
              <th>BIR Tax</th>
              <th>Total Deductions</th>
              <th>Net Pay</th>
            </tr>
          </thead>
          <tbody id="breakdownTableBody">
            <!-- Populated by JS -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- Empty State -->
    <div class="breakdown-empty-state" id="breakdownEmptyState" style="display: none;">
      <i class="fas fa-chart-pie"></i>
      <h3>No Deduction Data Available</h3>
      <p>Generate payslips to see your deduction breakdown and trends</p>
      <button class="btn-generate-payslip" onclick="document.querySelector('[data-page=\'generate-payslip\']').click()">
        <i class="fas fa-plus"></i> Generate Payslip
      </button>
    </div>

  </div>
</section>

    <!-- Settings Section -->
    <section class="content-section" id="settings">
      <div class="card">
        <h3 style="margin-bottom: 15px;">Preferences</h3>
        
        <!-- Theme Toggle -->
        <div class="form-group theme-toggle">
          <label style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;">
            <span>Dark Mode</span>
            <div class="toggle-switch">
              <input type="checkbox" id="themeCheckbox">
              <span class="slider round"></span>
            </div>
          </label>
        </div>

        <!-- Rate Configuration -->
        <div class="form-group">
          <label>Pay Rate Configuration</label>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
            <div>
              <label style="font-size: 12px; color: var(--text-secondary); display: block; margin-bottom: 6px;">Hourly Rate (PHP)</label>
              <input type="number" id="hourlyRateInput" placeholder="0.00" step="0.01" min="0">
            </div>
            <div>
              <label style="font-size: 12px; color: var(--text-secondary); display: block; margin-bottom: 6px;">Daily Rate (PHP)</label>
              <input type="number" id="dailyRateInput" placeholder="0.00" step="0.01" min="0">
            </div>
          </div>
          <button class="btn" id="updateRateBtn" style="width: 100%; margin-bottom: 20px;">
            <i class="fas fa-save" style="margin-right: 8px;"></i>Save Rate
          </button>
          <div id="rateStatusMessage" style="font-size: 12px; color: var(--text-secondary); display: none;"></div>
        </div>

        <!-- Password Section -->
        <hr style="border: none; border-top: 1px solid var(--border-color); margin: 20px 0;">
        
        <div class="form-group">
          <label>Current Password</label>
          <input type="password" id="currentPassword" placeholder="Enter current password">
        </div>
        <div class="form-group">
          <label>New Password</label>
          <input type="password" id="newPassword" placeholder="Enter new password">
        </div>
        <button class="btn" id="updatePasswordBtn" style="margin-right: 10px;">Update Password</button>
        <button class="btn" id="logoutBtn" style="background: #dc3545;">Logout</button>
      </div>

              <button class="btn" id="aboutBtn" style="margin-top: 20px; margin-bottom: 20px; width: 100%; background: linear-gradient(135deg, #667eea, #764ba2);">
  <i class="fas fa-info-circle"></i> About DutySync
</button>
      
    </section>

      <!-- Other Sections -->
      <section class="content-section" id="overview"><div class="card"><p>Overview content here...</p></div></section>
      <section class="content-section" id="reports"><div class="card"><p>Reports content here...</p></div></section>
      <section class="content-section" id="help"><div class="card"><p>Help content here...</p></div></section>
    </div>
    
    <!-- Logout Modal -->
    <div id="logoutModal" class="modal">
      <div class="modal-content">
        <h3>Logout Confirmation</h3>
        <p>Are you sure you want to logout?</p>
        <div class="modal-buttons">
          <button id="confirmLogout" class="btn btn-logout">Logout</button>
          <button id="cancelLogout" class="btn btn-cancel">Cancel</button>
        </div>
      </div>
    </div>

<!-- About Modal -->
<div class="about-modal-overlay" id="aboutModalOverlay">
  <button class="about-close-btn" id="aboutCloseBtn">&times;</button>
  
  <div class="about-modal-content">
    <!-- Header -->
    <div class="about-header">
      <div class="about-logo">
        <img src="../images/logo.png" class="about-logo-img">
      </div>
      <h2 class="about-title">DutySync</h2>
      <p class="about-subtitle">Version 1.0</p>
    </div>

    <!-- Description -->
    <div class="about-description">
      <p><strong>DutySync</strong> is a web-based system designed to help employees, especially working students, efficiently log their work hours and track their payroll.</p>
      <p style="margin-top: 10px;">The system allows users to input daily time in and time out, select duty types and automatically calculates gross and net pay with appropriate deductions.</p>
    </div>

<!-- Mission & Vision --> 
<div class="mission-vision">
  <div class="mission-card">
    <div class="card-icon">
      <i class="fas fa-bullseye fa-2x "></i> <!-- changed from fa-target to fa-bullseye -->
    </div>
    <h3 class="card-title">Our Mission</h3>
    <p class="card-text">To provide an easy, reliable system that helps employees track hours, track their payroll data, and manage their compensation with transparency and transparency.</p>
  </div>
  <div class="vision-card">
    <div class="card-icon">
      <i class="fas fa-lightbulb fa-2x"></i>
    </div>
    <h3 class="card-title">Our Vision</h3>
    <p class="card-text">To be the go-to platform that makes time tracking and payroll management simple, accurate, and accessible to every employee.</p>
  </div>
</div>


    <!-- Team Section -->
    <div class="team-section">
      <h3 class="section-title">DEVELOPMENT TEAM</h3>
      <div class="team-grid">
        <div class="team-member">
          <img src="../images/projectmanager.png" alt="Bathan, Mar Jerome S." class="member-avatar">
          <div class="member-info">
            <h4>Bathan, Mar Jerome S.</h4>
            <div class="member-role">Project Manager</div>
            <p class="member-description">Oversees the entire project, ensures the team meets deadlines, 
            manages resources, coordinates tasks, and communicates with 
            stakeholders to keep the project aligned with goals.</p>
          </div>
        </div>

        <div class="team-member">
          <img src="../images/systemanalyst.png" alt="Bunquin, Ruwie Charles A." class="member-avatar">
          <div class="member-info">
            <h4>Bunquin, Ruwie Charles A.</h4>
            <div class="member-role">System Analyst</div>
            <p class="member-description">Gathers and analyzes user requirements, studies existing processes, 
            identifies system needs, and creates detailed specifications to guide
            the development of the system.</p>
          </div>
        </div>

        <div class="team-member">
          <img src="../images/systemdesigner.png" alt="Macalalad, Roldan" class="member-avatar">
          <div class="member-info">
            <h4>Macalalad, Roldan</h4>
            <div class="member-role">UI/UX Designer</div>
            <p class="member-description">Transforms requirements into a system blueprint, designs the system architecture,
            database structure, user interface flow, and ensures the system is efficient,
            scalable, and user-friendly.</p>
          </div>
        </div>

        <div class="team-member">
          <img src="../images/developer.png" alt="Valida, Keil Rizher R." class="member-avatar">
          <div class="member-info">
            <h4>Valida, Keil Rizher R.</h4>
            <div class="member-role">Full Stack Developer</div>
            <p class="member-description">Develops the system from design to implementation, writes clean and 
              efficient code, integrates core features, resolves bugs, and collaborates with the team to ensure 
              smooth system performance.</p>
          </div>
        </div>

        <div class="team-member">
          <img src="../images/qualityassurance.png" alt="Bedar, Jomar Ichiro M." class="member-avatar">
          <div class="member-info">
            <h4>Bedar, Jomar Ichiro M.</h4>
            <div class="member-role">Quality Assurance</div>
            <p class="member-description">Tests the system to find defects, verifies that all features work as intended,
            ensures system reliability and performance, 
            and confirms the final product meets the required standards.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Tech Stack -->
    <div class="tech-section">
      <h3 class="section-title">TECHNOLOGIES USED</h3>
      <div class="tech-breakdown">
        <div class="tech-breakdown-item">
          <div class="tech-breakdown-label">
            <i class="fab fa-js-square"></i> JavaScript
          </div>
          <div class="tech-breakdown-bar">
            <div class="tech-breakdown-fill" style="width: 80%; background: linear-gradient(90deg, #F7DF1E, #F1D40F);"></div>
          </div>
          <div class="tech-breakdown-percent">80%</div>
        </div>

        <div class="tech-breakdown-item">
          <div class="tech-breakdown-label">
            <i class="fab fa-html5"></i> HTML
          </div>
          <div class="tech-breakdown-bar">
            <div class="tech-breakdown-fill" style="width: 70%; background: linear-gradient(90deg, #E34C26, #FF6B35);"></div>
          </div>
          <div class="tech-breakdown-percent">70%</div>
        </div>

        <div class="tech-breakdown-item">
          <div class="tech-breakdown-label">
            <i class="fab fa-css3-alt"></i> CSS
          </div>
          <div class="tech-breakdown-bar">
            <div class="tech-breakdown-fill" style="width: 45%; background: linear-gradient(90deg, #563D7C, #9C27B0);"></div>
          </div>
          <div class="tech-breakdown-percent">45%</div>
        </div>

        <div class="tech-breakdown-item">
          <div class="tech-breakdown-label">
            <i class="fas fa-fire"></i> Firebase
          </div>
          <div class="tech-breakdown-bar">
            <div class="tech-breakdown-fill" style="width: 30%; background: linear-gradient(90deg, #FFCA28, #FF6F00);"></div>
          </div>
          <div class="tech-breakdown-percent">30%</div>
        </div>

        <div class="tech-breakdown-item">
          <div class="tech-breakdown-label">
            <i class="fas fa-pencil-alt"></i> Figma
          </div>
          <div class="tech-breakdown-bar">
            <div class="tech-breakdown-fill" style="width: 100%; background: linear-gradient(90deg, #A259FF, #FF61F6);"></div>
          </div>
          <div class="tech-breakdown-percent">100%</div>
        </div>

        <div class="tech-breakdown-item">
          <div class="tech-breakdown-label">
            <i class="fas fa-chart-line"></i> Chart.js
          </div>
          <div class="tech-breakdown-bar">
            <div class="tech-breakdown-fill" style="width: 20%; background: linear-gradient(90deg, #FF6384, #FF9FF3);"></div>
          </div>
          <div class="tech-breakdown-percent">20%</div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="about-footer">
      <p>&copy; 2025 DutySync. All rights reserved.</p>
    </div>
  </div>
</div>
  <!-- Firebase + JS -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
  <script src="../js/script.js"></script>
  <script src="../js/inputduty.js"></script>
  <script src="../js/viewdutylog.js"></script>
  <script src="../js/profile.js"></script>
  <script src="../js/viewpayslip.js"></script>
  <script src="../js/generate.js"></script>
  <script src="../js/deduction-breakdown.js"></script>

</body>
</html>